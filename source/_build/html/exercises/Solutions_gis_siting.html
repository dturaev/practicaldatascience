<!DOCTYPE html> <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../_static/javascripts/modernizr.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XX133829453-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'UA-XX133829453-1'); </script> <title>Locating a New Grocery Store &#8212; Practical Data Science</title> <link rel=stylesheet  type="text/css" href="../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../_static/material.css" /> <script data-url_root="../" id=documentation_options  src="../_static/documentation_options.js"></script> <script src="../_static/jquery.js"></script> <script src="../_static/underscore.js"></script> <script src="../_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script async=async  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <link rel="shortcut icon" href="../_static/mids_logo.svg"/> <link rel=index  title=Index  href="../genindex.html" /> <link rel=search  title=Search  href="../search.html" /> <body dir=ltr data-md-color-primary=blue-grey data-md-color-accent=blue> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#exercises/Solutions_gis_siting" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../index.html" title="Practical Data Science" class="md-header-nav__button md-logo"> <img src="../_static/mids_logo.svg" height=26  alt="Practical Data Science logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >Practical Data Science</span> <span class=md-header-nav__topic > Locating a New Grocery Store </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <script src="../_static/javascripts/version_dropdown.js"></script> <script> var json_loc = "../"versions.json"", target_loc = "../../", text = "Versions"; $( document ).ready( add_version_dropdown(json_loc, target_loc, text)); </script> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../index.html" class=md-tabs__link >Home</a> <li class=md-tabs__item ><a href="../class_schedule.html" class=md-tabs__link >Class Schedule</a> <li class=md-tabs__item ><a href="../topic_list.html" class=md-tabs__link >Topic List</a> <li class=md-tabs__item ><a href="https://www.nickeubank.com" class=md-tabs__link >About The Author</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../index.html" title="Practical Data Science" class="md-nav__button md-logo"> <img src="../_static/mids_logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../index.html" title="Practical Data Science">Practical Data Science</a> </label> <ul class=md-nav__list > <li class=md-nav__item > <a href="../class_schedule.html" class=md-nav__link >Class Schedule</a> <li class=md-nav__item > <a href="../topic_list.html" class=md-nav__link >Topic List</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Environment Setup</span></span> <li class=md-nav__item > <a href="../setting_up_your_computer.html" class=md-nav__link >Setup Computer for Data Science</a> <li class=md-nav__item > <a href="../vscode.html" class=md-nav__link >Using VS Code For Data Science</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Basic Tools</span></span> <li class=md-nav__item > <a href="../command_line_part1.html" class=md-nav__link >Command Line, Basics</a> <li class=md-nav__item > <a href="../command_line_part2.html" class=md-nav__link >Command Line, Advanced</a> <li class=md-nav__item > <a href="../jupyter.html" class=md-nav__link >Jupyter</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Python &amp; Pandas</span></span> <li class=md-nav__item > <a href="../python_v_r.html" class=md-nav__link >Python / R Differences</a> <li class=md-nav__item > <a href="../vars_v_objects.html" class=md-nav__link >Python: Vars v Objects</a> <li class=md-nav__item > <a href="../ints_and_floats.html" class=md-nav__link >Numbers in Computers</a> <li class=md-nav__item > <a href="../pandas_series.html" class=md-nav__link >Pandas 1: Series</a> <li class=md-nav__item > <a href="../pandas_dataframes.html" class=md-nav__link >Pandas 2: DataFrames</a> <li class=md-nav__item > <a href="../plotting_altair_part1.html" class=md-nav__link >Plotting, Basics</a> <li class=md-nav__item > <a href="../plotting_altair_part2.html" class=md-nav__link >Plotting, Advanced</a> <li class=md-nav__item > <a href="../views_and_copies_in_pandas.html" class=md-nav__link >Pandas 3: Views</a> <li class=md-nav__item > <a href="../parquet.html" class=md-nav__link >Parquet Format</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >DS Concepts</span></span> <li class=md-nav__item > <a href="../defensive_programming.html" class=md-nav__link >Defensive Programming</a> <li class=md-nav__item > <a href="../workflow.html" class=md-nav__link >Workflow Management</a> <li class=md-nav__item > <a href="../backwards_design.html" class=md-nav__link >Backwards Design</a> <li class=md-nav__item > <a href="../getting_help.html" class=md-nav__link >Getting Help Online</a> <li class=md-nav__item > <a href="../what_is_big_data.html" class=md-nav__link >What is Big Data?</a> <li class=md-nav__item > <a href="../big_data_strategies.html" class=md-nav__link >Working with Big Data</a> <li class=md-nav__item > <a href="../performance_understanding.html" class=md-nav__link >Understanding Performance</a> <li class=md-nav__item > <a href="../performance_solutions.html" class=md-nav__link >Solving Performance Probs</a> <li class=md-nav__item > <a href="../parallelism.html" class=md-nav__link >Parallel Computing</a> <li class=md-nav__item > <a href="../distributed_computing.html" class=md-nav__link >Distributed Computing</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Git and Github</span></span> <li class=md-nav__item > <a href="../git_and_github.html" class=md-nav__link >Git and Github</a> <li class=md-nav__item > <a href="../pr_review.html" class=md-nav__link >Reviewing Code on Github</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >GIS</span></span> <li class=md-nav__item > <a href="../gis_what_is_gis.html" class=md-nav__link >What is GIS?</a> <li class=md-nav__item > <a href="../gis_setup_geopandas.html" class=md-nav__link >Installing Geopandas</a> <li class=md-nav__item > <a href="../gis_geopandas.html" class=md-nav__link >Geopandas</a> <li class=md-nav__item > <a href="../gis_spatial_joins.html" class=md-nav__link >Merging Spatial Data</a> <li class=md-nav__item > <a href="../gis_data.html" class=md-nav__link >Spatial Data Formats</a> <li class=md-nav__item > <a href="../gis_projections.html" class=md-nav__link >Spatial Projections</a> <li class=md-nav__item > <a href="../gis_crs_geopandas.html" class=md-nav__link >Managing Projections in Geopandas</a> <li class=md-nav__item > <a href="../gis_mapping.html" class=md-nav__link >Mapping with Geopandas</a> <li class=md-nav__item > <span class="md-nav__link caption"><span class=caption-text >Other</span></span> <li class=md-nav__item > <a href="../buying_datascience_computer.html" class=md-nav__link >Buying a Data Science Computer</a> <li class=md-nav__item > <a href="../not_a_mids_student.html" class=md-nav__link >Not a MIDS Student?</a> <li class=md-nav__item > <a href="../cheatsheets.html" class=md-nav__link >Cheat Sheets</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#exercises-solutions-gis-siting--page-root" class=md-nav__link >Locating a New Grocery Store</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Exercise-1" class=md-nav__link >Exercise 1</a> <li class=md-nav__item ><a href="#Exercise-2" class=md-nav__link >Exercise 2</a> <li class=md-nav__item ><a href="#Exercise-3" class=md-nav__link >Exercise 3</a> <li class=md-nav__item ><a href="#Exercise-4" class=md-nav__link >Exercise 4</a> <li class=md-nav__item ><a href="#Exercise-5" class=md-nav__link >Exercise 5</a> <li class=md-nav__item ><a href="#Exercise-6" class=md-nav__link >Exercise 6</a> <li class=md-nav__item ><a href="#Exercise-7" class=md-nav__link >Exercise 7</a> <li class=md-nav__item ><a href="#Exercise-8" class=md-nav__link >Exercise 8</a> <li class=md-nav__item ><a href="#Exercise-9" class=md-nav__link >Exercise 9</a> <li class=md-nav__item ><a href="#Exercise-10" class=md-nav__link >Exercise 10</a> <li class=md-nav__item ><a href="#Exercise-11" class=md-nav__link >Exercise 11</a> <li class=md-nav__item ><a href="#Exercise-12" class=md-nav__link >Exercise 12</a> <li class=md-nav__item ><a href="#Exercise-13" class=md-nav__link >Exercise 13</a> </ul> </nav> </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <style> /* CSS for nbsphinx extension */ /* remove conflicting styling from Sphinx themes */ div.nbinput.container div.prompt *, div.nboutput.container div.prompt *, div.nbinput.container div.input_area pre, div.nboutput.container div.output_area pre, div.nbinput.container div.input_area .highlight, div.nboutput.container div.output_area .highlight { border: none; padding: 0; margin: 0; box-shadow: none; } div.nbinput.container > div[class*=highlight], div.nboutput.container > div[class*=highlight] { margin: 0; } div.nbinput.container div.prompt *, div.nboutput.container div.prompt * { background: none; } div.nboutput.container div.output_area .highlight, div.nboutput.container div.output_area pre { background: unset; } div.nboutput.container div.output_area div.highlight { color: unset; /* override Pygments text color */ } /* avoid gaps between output lines */ div.nboutput.container div[class*=highlight] pre { line-height: normal; } /* input/output containers */ div.nbinput.container, div.nboutput.container { display: -webkit-flex; display: flex; align-items: flex-start; margin: 0; width: 100%; } @media (max-width: 540px) { div.nbinput.container, div.nboutput.container { flex-direction: column; } } /* input container */ div.nbinput.container { padding-top: 5px; } /* last container */ div.nblast.container { padding-bottom: 5px; } /* input prompt */ div.nbinput.container div.prompt pre { color: #307FC1; } /* output prompt */ div.nboutput.container div.prompt pre { color: #BF5B3D; } /* all prompts */ div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: 4.5ex; padding-top: 5px; position: relative; user-select: none; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: absolute; right: 0; margin-right: 0.3ex; } @media (max-width: 540px) { div.nbinput.container div.prompt, div.nboutput.container div.prompt { width: unset; text-align: left; padding: 0.4em; } div.nboutput.container div.prompt.empty { padding: 0; } div.nbinput.container div.prompt > div, div.nboutput.container div.prompt > div { position: unset; } } /* disable scrollbars on prompts */ div.nbinput.container div.prompt pre, div.nboutput.container div.prompt pre { overflow: hidden; } /* input/output area */ div.nbinput.container div.input_area, div.nboutput.container div.output_area { -webkit-flex: 1; flex: 1; overflow: auto; } @media (max-width: 540px) { div.nbinput.container div.input_area, div.nboutput.container div.output_area { width: 100%; } } /* input area */ div.nbinput.container div.input_area { border: 1px solid #e0e0e0; border-radius: 2px; /*background: #f5f5f5;*/ } /* override MathJax center alignment in output cells */ div.nboutput.container div[class*=MathJax] { text-align: left !important; } /* override sphinx.ext.imgmath center alignment in output cells */ div.nboutput.container div.math p { text-align: left; } /* standard error */ div.nboutput.container div.output_area.stderr { background: #fdd; } /* ANSI colors */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } div.nbinput.container div.input_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight] > pre, div.nboutput.container div.output_area div[class*=highlight].math, div.nboutput.container div.output_area.rendered_html, div.nboutput.container div.output_area > div.output_javascript, div.nboutput.container div.output_area:not(.rendered_html) > img{ padding: 5px; margin: 0; } /* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */ div.nbinput.container div.input_area > div[class^='highlight'], div.nboutput.container div.output_area > div[class^='highlight']{ overflow-y: hidden; } /* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */ .prompt a.copybtn { display: none; } /* Some additional styling taken form the Jupyter notebook CSS */ div.rendered_html table { border: none; border-collapse: collapse; border-spacing: 0; color: black; font-size: 12px; table-layout: fixed; } div.rendered_html thead { border-bottom: 1px solid black; vertical-align: bottom; } div.rendered_html tr, div.rendered_html th, div.rendered_html td { text-align: right; vertical-align: middle; padding: 0.5em 0.5em; line-height: normal; white-space: normal; max-width: none; border: none; } div.rendered_html th { font-weight: bold; } div.rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } div.rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } </style> <h1 id=exercises-solutions-gis-siting--page-root >Locating a New Grocery Store<a class=headerlink  href="#exercises-solutions-gis-siting--page-root" title="Permalink to this headline">¶</a></h1> <p>Congratulations! You’ve been hired by Whole Foods to help them identify potential locations for a new store in New York.</p> <p>To aid in your analysis, we will be working with a dataset of <em>all</em> retail food stores in New York provided by the NY Department of Agriculture and Markets. The source for the <a class="reference external" href="https://data.ny.gov/Economic-Development/Retail-Food-Stores/9a8c-vfzj">data is here</a>, but please work from the copy of the <a class="reference external" href="https://github.com/nickeubank/practicaldatascience/blob/master/Example_Data/gis_siting/ny_census_blockgroups_2019.zip">data here</a>. We will use this data to identify areas that are under-served by grocery stores today (e.g. to find market opportunities).</p> <p>Of course, it’s not enough to know where grocery stores currently are or are not – if it were, we could just advise our client to put some grocery stores out in the middle of no where! So we’ll also be using some demographic data from the US American Communities Survey (downloaded from NHGIS). You can find that <a class="reference external" href="https://github.com/nickeubank/practicaldatascience/blob/master/Example_Data/gis_siting/ny_census_blockgroups_2019.zip">data here</a>. This is all public data, and as such is not nearly as detailed as data you can buy from marketing professionals, but even so you’ll see we can get a lot of value from it.</p> <h2 id=Exercise-1 >Exercise 1<a class=headerlink  href="#Exercise-1" title="Permalink to this headline">¶</a></h2> <p>Please download, import, and plot both datasets.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=kn >import</span> <span class=nn >geopandas</span> <span class=k >as</span> <span class=nn >gpd</span>

<span class=n >food</span> <span class=o >=</span> <span class=n >gpd</span><span class=o >.</span><span class=n >read_file</span><span class=p >(</span>
    <span class=s2 >"https://github.com/nickeubank/practicaldatascience/raw/"</span>
    <span class=s2 >"master/Example_Data/gis_siting/ny_retail_food.zip"</span>
<span class=p >)</span>
<span class=n >food</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_2_1.png" src="../_images/exercises_Solutions_gis_siting_2_1.png"/> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >census</span> <span class=o >=</span> <span class=n >gpd</span><span class=o >.</span><span class=n >read_file</span><span class=p >(</span>
    <span class=s2 >"https://github.com/nickeubank/practicaldatascience/raw/"</span>
    <span class=s2 >"master/Example_Data/gis_siting/ny_census_blockgroups_2019.zip"</span>
<span class=p >)</span>
<span class=n >census</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_3_1.png" src="../_images/exercises_Solutions_gis_siting_3_1.png"/> </div> </div> <h2 id=Exercise-2 >Exercise 2<a class=headerlink  href="#Exercise-2" title="Permalink to this headline">¶</a></h2> <p>Let’s begin by establishing where our CURRENT Whole Foods stores are located. Please create a new GeoDataFrame consisting of all Whole Foods locations in New York. How many Whole Foods are there currently in New York? Where are they predominantly located?</p> <p>If you have questions about the variables in the NY retail food database, you can find all the documentation provided by the NY State Department of Agriculture and Markets <a class="reference external" href="https://github.com/nickeubank/practicaldatascience/tree/master/Example_Data/gis_siting">in this folder</a>.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >food</span><span class=o >.</span><span class=n >sample</span><span class=p >(</span><span class=mi >3</span><span class=p >)</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <div> <style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>county <th>license_nu <th>operation_ <th>estab_type <th>entity_nam <th>dba_name <th>street_num <th>street_nam <th>address_li <th>address__2 <th>city <th>state <th>zip_code <th>square_foo <th>geometry <tr> <th>21128 <td>Bronx <td>606363 <td>Store <td>JAC <td>IGUA FOOD CORP <td>CHERRY VALLEY MARKETPLA <td>421 <td>E 189TH ST <td>None <td>None <td>BRONX <td>NY <td>10458 <td>6000.0 <td>POINT (1836521.566 430227.939) <tr> <th>2518 <td>Queens <td>745144 <td>Store <td>JAC <td>NEW SEAFOOD INC <td>NEW SEAFOOD <td>46-02 <td>QUEENS BLVD. <td>None <td>None <td>SUNNYSIDE <td>NY <td>11104 <td>0.0 <td>POINT (1837479.006 417051.016) <tr> <th>3254 <td>Albany <td>743725 <td>Store <td>JAC <td>KNOX CAFE LLC <td>CROWING HEN CAFE <td>2055 <td>DELAWARE TRPK <td>None <td>None <td>CLARKSVILLE <td>NY <td>12041 <td>2000.0 <td>POINT (1785122.613 613811.187) </table> </div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >entities</span> <span class=o >=</span> <span class=n >food</span><span class=o >.</span><span class=n >entity_nam</span><span class=o >.</span><span class=n >value_counts</span><span class=p >()</span><span class=o >.</span><span class=n >reset_index</span><span class=p >()</span>
<span class=n >entities</span><span class=p >[</span><span class=n >entities</span><span class=p >[</span><span class=s2 >"index"</span><span class=p >]</span><span class=o >.</span><span class=n >str</span><span class=o >.</span><span class=n >contains</span><span class=p >(</span><span class=s2 >"WHOLE FOODS"</span><span class=p >)]</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <div> <style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>index <th>entity_nam <tr> <th>49 <td>WHOLE FOODS MARKET GROUP INC <td>23 <tr> <th>1349 <td>WHOLE FOODS MARKET GROUP, INC. <td>1 <tr> <th>1987 <td>GARY NULLS UPTOWN WHOLE FOODS INC <td>1 <tr> <th>7636 <td>DOWN TO EARTH WHOLE FOODS INC <td>1 <tr> <th>8331 <td>HAMILTON WHOLE FOODS LTD <td>1 <tr> <th>21053 <td>WHOLE FOODS MARKET GROUP IN <td>1 </table> </div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >wholefoods</span> <span class=o >=</span> <span class=n >food</span><span class=p >[</span><span class=n >food</span><span class=p >[</span><span class=s2 >"entity_nam"</span><span class=p >]</span><span class=o >.</span><span class=n >str</span><span class=o >.</span><span class=n >contains</span><span class=p >(</span><span class=s2 >"WHOLE FOODS MARKET GROUP"</span><span class=p >)]</span>
<span class=n >wholefoods</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_7_1.png" src="../_images/exercises_Solutions_gis_siting_7_1.png"/> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=nb >print</span><span class=p >(</span><span class=sa >f</span><span class=s2 >"there are </span><span class=si >{</span><span class=nb >len</span><span class=p >(</span><span class=n >wholefoods</span><span class=p >)</span><span class=si >}</span><span class=s2 > whole foods in New York State"</span><span class=p >)</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
there are 25 whole foods in New York State
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >wholefoods</span><span class=o >.</span><span class=n >city</span><span class=o >.</span><span class=n >value_counts</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
NEW YORK        11
BROOKLYN         3
GARDEN CITY      1
COMMACK          1
CHAPPAQUA        1
BUFFALO          1
ALBANY           1
PORT CHESTER     1
YONKERS          1
WHITE PLAINS     1
LAKE GROVE       1
JERICHO          1
MUNSEY PARK      1
Name: city, dtype: int64
</pre></div></div> </div> <p>And they’re almost all in and around Manhattan / Long Island.</p> <h2 id=Exercise-3 >Exercise 3<a class=headerlink  href="#Exercise-3" title="Permalink to this headline">¶</a></h2> <p>Now let’s create a GeoDataFrame with competing grocery stores. In the NY area, we’ll limit attention to Walmart (hint – there are a lot of walmarts), ACME Markets (Albertson’s), Trader Joe’s, ALDI, and any stores identifying themselves as supermarkets or super markets. Grocery, as a search term, catches a lot of delis and bodegas, which aren’t really in competition with Whole Foods.</p> <p>(Note that in a real analysis, you’d want to be a little more careful to include any other non-chain grocery stores!)</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># There are a lot of ways one might approach this, but I'm gonna go with</span>
<span class=c1 ># operation_ is Store, and entity_nam includes Grocery.</span>
<span class=n >matches</span> <span class=o >=</span> <span class=s2 >"(SUPER MARKET|SUPERMARKET|ALDI|TRADER JOE|ACME|WALMART)"</span>

<span class=n >food</span> <span class=o >=</span> <span class=n >food</span> <span class=o >=</span> <span class=n >food</span><span class=p >[</span><span class=n >food</span><span class=o >.</span><span class=n >dba_name</span><span class=o >.</span><span class=n >notnull</span><span class=p >()]</span>
<span class=n >competitors</span> <span class=o >=</span> <span class=n >food</span><span class=p >[</span>
    <span class=n >food</span><span class=o >.</span><span class=n >dba_name</span><span class=o >.</span><span class=n >str</span><span class=o >.</span><span class=n >contains</span><span class=p >(</span><span class=n >matches</span><span class=p >)</span> <span class=o >|</span> <span class=n >food</span><span class=o >.</span><span class=n >entity_nam</span><span class=o >.</span><span class=n >str</span><span class=o >.</span><span class=n >contains</span><span class=p >(</span><span class=n >matches</span><span class=p >)</span>
<span class=p >]</span><span class=o >.</span><span class=n >copy</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area stderr docutils container"> <div class=highlight ><pre>
/var/folders/tj/s8f2_ks15h315z5thvtnhz8r0000gp/T/ipykernel_54292/2114573374.py:7: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.
  food.dba_name.str.contains(matches) | food.entity_nam.str.contains(matches)
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >competitors</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_13_1.png" src="../_images/exercises_Solutions_gis_siting_13_1.png"/> </div> </div> <h2 id=Exercise-4 >Exercise 4<a class=headerlink  href="#Exercise-4" title="Permalink to this headline">¶</a></h2> <p>Now comes the fun part!</p> <p>In the census data we loaded previously, we have information on the population, average income, and average education for every census block group (a “block group” is an official level of aggregation) in New York. But we <em>don’t</em> know how close those people are to an existing grocery store! So let’s use the data we’ve now created to gather information about what communities may currently be under-served by local grocery stores!</p> <p>The first thing we want to do is rule out locations near existing Whole Foods.</p> <p>Using <code class="docutils literal notranslate"><span class=pre >sjoin_nearest</span></code>, find the closest <em>Whole Foods</em> to every census block group. Also use the <code class="docutils literal notranslate"><span class=pre >distance_col</span></code> keyword argument (you can use <code class="docutils literal notranslate"><span class=pre >sjoin_nearest?</span></code> to read about it) to get the actual distance to said nearest Whole Foods.</p> <p>Note that distance you get from this operation will be in meters because of how our data is being represented (it’s projection – something we’ll read about for our second GIS class).</p> <p>Also note that we’re getting the distance to the nearest Whole Foods <em>from each census block group</em>, which are polygons. geopandas is smart enough to calculate the <em>shortest</em> distance from the polygon (i.e. the distance from the point on the polygon edge that is closest to the Whole Foods!).</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates</span> <span class=o >=</span> <span class=n >census</span><span class=o >.</span><span class=n >sjoin_nearest</span><span class=p >(</span>
    <span class=n >wholefoods</span><span class=p >[[</span><span class=s2 >"geometry"</span><span class=p >]],</span> <span class=n >distance_col</span><span class=o >=</span><span class=s2 >"nearest_whole_foods"</span>
<span class=p >)</span>

</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates</span><span class=o >.</span><span class=n >nearest_whole_foods</span><span class=o >.</span><span class=n >describe</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
count     15247.000000
mean      40981.706894
std       60865.636911
min           0.000000
25%        5144.958017
50%       10075.343923
75%       51986.798788
max      262389.536178
Name: nearest_whole_foods, dtype: float64
</pre></div></div> </div> <h2 id=Exercise-5 >Exercise 5<a class=headerlink  href="#Exercise-5" title="Permalink to this headline">¶</a></h2> <p>Let’s start building a dataset of possible grocery locations. First, let’s drop any census block groups that aren’t urban (Whole Foods are really an urban company). To do so, calculate the population density of each census block group and drop any census block groups with population densities below 100 people per square kilometer (bearing in mind that the units of this map are meters, so <code class="docutils literal notranslate"><span class=pre >.area</span></code> will return an area in meters squared).</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[12]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates</span><span class=p >[</span><span class=s2 >"density"</span><span class=p >]</span> <span class=o >=</span> <span class=n >candidates</span><span class=o >.</span><span class=n >population</span> <span class=o >/</span> <span class=p >(</span><span class=n >candidates</span><span class=o >.</span><span class=n >area</span> <span class=o >/</span> <span class=mi >1_000_000</span><span class=p >)</span>
<span class=n >candidates</span> <span class=o >=</span> <span class=n >candidates</span><span class=p >[</span><span class=n >candidates</span><span class=p >[</span><span class=s2 >"density"</span><span class=p >]</span> <span class=o >&gt;=</span> <span class=mi >100</span><span class=p >]</span><span class=o >.</span><span class=n >copy</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_19_1.png" src="../_images/exercises_Solutions_gis_siting_19_1.png"/> </div> </div> <h2 id=Exercise-6 >Exercise 6<a class=headerlink  href="#Exercise-6" title="Permalink to this headline">¶</a></h2> <p>Now drop any block groups that are already less than 8 km from a Whole Foods.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[14]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates</span> <span class=o >=</span> <span class=n >candidates</span><span class=p >[</span><span class=n >candidates</span><span class=o >.</span><span class=n >nearest_whole_foods</span> <span class=o >&gt;</span> <span class=mi >8000</span><span class=p >]</span>

</pre></div> </div> </div> <h2 id=Exercise-7 >Exercise 7<a class=headerlink  href="#Exercise-7" title="Permalink to this headline">¶</a></h2> <p>Now, for each remaining block group, calculate the distance to the nearest NON-Whole Foods. What does the distribution of those distances look like?</p> <p>NOTE: When geopandas finds multiple observations at the same distance, it will keep them all. That can cause problems here – because there may be MULTIPLE competitors in the same block group you can end up with block groups being duplicated. Since we only care about the <em>distance</em> to the nearest competitor (not whether there are multiple at distance 0), drop these duplicates. Your observations should be unique on <code class="docutils literal notranslate"><span class=pre >["STATEFP",</span> <span class=pre >"COUNTYFP",</span> <span class=pre >"TRACTCE",</span> <span class=pre >"BLKGRPCE"]</span></code>.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[15]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates</span> <span class=o >=</span> <span class=n >candidates</span><span class=o >.</span><span class=n >drop</span><span class=p >(</span><span class=s2 >"index_right"</span><span class=p >,</span> <span class=n >axis</span><span class=o >=</span><span class=s2 >"columns"</span><span class=p >)</span>
<span class=n >candidates_w_dists</span> <span class=o >=</span> <span class=n >candidates</span><span class=o >.</span><span class=n >sjoin_nearest</span><span class=p >(</span>
    <span class=n >competitors</span><span class=p >[[</span><span class=s2 >"geometry"</span><span class=p >]],</span> <span class=n >distance_col</span><span class=o >=</span><span class=s2 >"other_grocer"</span>
<span class=p >)</span>
<span class=n >candidates_w_dists</span> <span class=o >=</span> <span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >drop</span><span class=p >(</span><span class=s2 >"index_right"</span><span class=p >,</span> <span class=n >axis</span><span class=o >=</span><span class=s2 >"columns"</span><span class=p >)</span>

</pre></div> </div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[16]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates_w_dists</span> <span class=o >=</span> <span class=n >candidates_w_dists</span><span class=p >[</span><span class=o >~</span><span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >duplicated</span><span class=p >()]</span>
</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[17]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >other_grocer</span><span class=o >.</span><span class=n >hist</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[17]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_25_1.png" src="../_images/exercises_Solutions_gis_siting_25_1.png"/> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[18]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >other_grocer</span><span class=o >.</span><span class=n >describe</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[18]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
count     7111.000000
mean      2553.262476
std       5015.403833
min          0.000000
25%        398.480866
50%       1122.292634
75%       2444.358829
max      60365.060417
Name: other_grocer, dtype: float64
</pre></div></div> </div> <h2 id=Exercise-8 >Exercise 8<a class=headerlink  href="#Exercise-8" title="Permalink to this headline">¶</a></h2> <p>We’re now close to identifying places that are urban, not too close to an existing Whole Foods, and not too close to an existing competitor! We’re almost there!</p> <p>But before we filter on distance to the nearest competitor, let’s also think about what a Whole Foods customer looks like. If this were a real consulting gig, we could ask Whole Foods for data on their current customers, but for the moment let’s just assert that they tend to be wealthy and highly educated.</p> <p>Our census data already has a variable with median household income (<code class="docutils literal notranslate"><span class=pre >md_hh_inc</span></code>). Now also construct a variable the gives us the share of people over 25 in each Block Group that have at least a Bachelors Degree. This will entail using the variables that start with <code class="docutils literal notranslate"><span class=pre >ALWG</span></code> along with information from the codebook we referenced before.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[19]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates_w_dists</span><span class=p >[</span><span class=s2 >"share_with_college"</span><span class=p >]</span> <span class=o >=</span> <span class=p >(</span>
    <span class=n >candidates_w_dists</span><span class=p >[</span><span class=s2 >"ALWGE022"</span><span class=p >]</span>
    <span class=o >+</span> <span class=n >candidates_w_dists</span><span class=p >[</span><span class=s2 >"ALWGE023"</span><span class=p >]</span>
    <span class=o >+</span> <span class=n >candidates_w_dists</span><span class=p >[</span><span class=s2 >"ALWGE024"</span><span class=p >]</span>
    <span class=o >+</span> <span class=n >candidates_w_dists</span><span class=p >[</span><span class=s2 >"ALWGE025"</span><span class=p >]</span>
<span class=p >)</span> <span class=o >/</span> <span class=n >candidates_w_dists</span><span class=p >[</span><span class=s2 >"ALWGE001"</span><span class=p >]</span>
<span class=n >candidates_w_dists</span><span class=p >[</span><span class=s2 >"share_with_college"</span><span class=p >]</span><span class=o >.</span><span class=n >describe</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[19]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
count    7108.000000
mean        0.327890
std         0.180452
min         0.000000
25%         0.192330
50%         0.302840
75%         0.442879
max         0.977113
Name: share_with_college, dtype: float64
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[20]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >md_hh_inc</span><span class=o >.</span><span class=n >describe</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[20]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
count      6819.000000
mean      76128.995161
std       37445.467404
min        3393.000000
25%       48942.000000
50%       71000.000000
75%       97917.000000
max      250001.000000
Name: md_hh_inc, dtype: float64
</pre></div></div> </div> <h2 id=Exercise-9 >Exercise 9<a class=headerlink  href="#Exercise-9" title="Permalink to this headline">¶</a></h2> <p>Great! At this point, we have four variables we’re selecting on: share with college, median household income, distance to nearest competitor, and distance to nearest Whole Foods. These’s no obvious way to balance these considerations, but for the moment let’s look for places where the share of people with college degrees is over 50%, median household income is over $90,000, and the nearest competitor’s grocery store is more than 8km away, and the nearest Whole Foods is over 8km away.</p> <p>Using these filters, can you identify any counties that seem like especially good candidates (e.g. counties with a fair number of people in census block groups that fit our criteria?)</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[21]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span> <span class=o >=</span> <span class=n >candidates_w_dists</span><span class=p >[</span>
    <span class=p >(</span><span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >md_hh_inc</span> <span class=o >&gt;</span> <span class=mi >90_000</span><span class=p >)</span>
    <span class=o >&amp;</span> <span class=p >(</span><span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >share_with_college</span> <span class=o >&gt;</span> <span class=mf >0.5</span><span class=p >)</span>
    <span class=o >&amp;</span> <span class=p >(</span><span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >other_grocer</span> <span class=o >&gt;</span> <span class=mi >8000</span><span class=p >)</span>
<span class=p >]</span>

</pre></div> </div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[22]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span> <span class=o >=</span> <span class=n >finals</span><span class=p >[</span>
    <span class=p >[</span>
        <span class=s2 >"COUNTY"</span><span class=p >,</span>
        <span class=s2 >"PLACEA"</span><span class=p >,</span>
        <span class=s2 >"population"</span><span class=p >,</span>
        <span class=s2 >"md_hh_inc"</span><span class=p >,</span>
        <span class=s2 >"geometry"</span><span class=p >,</span>
        <span class=s2 >"nearest_whole_foods"</span><span class=p >,</span>
        <span class=s2 >"density"</span><span class=p >,</span>
        <span class=s2 >"other_grocer"</span><span class=p >,</span>
        <span class=s2 >"share_with_college"</span>
    <span class=p >]</span>
<span class=p >]</span>

</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[23]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[23]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_33_1.png" src="../_images/exercises_Solutions_gis_siting_33_1.png"/> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[24]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span><span class=o >.</span><span class=n >COUNTY</span><span class=o >.</span><span class=n >value_counts</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[24]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Saratoga County        12
Westchester County      9
Suffolk County          8
Putnam County           2
Cayuga County           1
Onondaga County         1
St. Lawrence County     1
Chautauqua County       1
Niagara County          1
Erie County             1
Oswego County           1
Name: COUNTY, dtype: int64
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[25]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span><span class=o >.</span><span class=n >groupby</span><span class=p >(</span><span class=s2 >"COUNTY"</span><span class=p >,</span> <span class=n >as_index</span><span class=o >=</span><span class=kc >False</span><span class=p >)[[</span><span class=s2 >"population"</span><span class=p >]]</span><span class=o >.</span><span class=n >sum</span><span class=p >()</span><span class=o >.</span><span class=n >sort_values</span><span class=p >(</span><span class=s2 >"population"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[25]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <div> <style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>COUNTY <th>population <tr> <th>1 <td>Chautauqua County <td>366 <tr> <th>0 <td>Cayuga County <td>503 <tr> <th>8 <td>St. Lawrence County <td>744 <tr> <th>2 <td>Erie County <td>1074 <tr> <th>5 <td>Oswego County <td>1185 <tr> <th>3 <td>Niagara County <td>1307 <tr> <th>4 <td>Onondaga County <td>2422 <tr> <th>6 <td>Putnam County <td>2433 <tr> <th>9 <td>Suffolk County <td>5816 <tr> <th>10 <td>Westchester County <td>15307 <tr> <th>7 <td>Saratoga County <td>16349 </table> </div></div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[26]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=c1 ># Saratoga County and Westchester County?! Maybe?</span>
</pre></div> </div> </div> <h2 id=Exercise-10 >Exercise 10<a class=headerlink  href="#Exercise-10" title="Permalink to this headline">¶</a></h2> <p>Great work! We’ve found some candidates!</p> <p>However, it’s worth noting that we have been a little crude here in a couple ways. First, obviously, in the real world we’d want more information on what demographic features best predict someone being a Whole Foods customer so we can put some weights on these various filters we’re applying.</p> <p>But looking at distance to the <em>nearest</em> grocery store is also a bit of a crude approach to understanding potential customer’s grocery access. So let’s take a new approach!</p> <p>Rather than measuring the distance to the nearest grocery story, let’s look at the number of grocery stores within 15km of each block group.</p> <p>To do this, we’ll begin by using <code class="docutils literal notranslate"><span class=pre >buffer()</span></code> to expand each block group outward by the buffered distance. Then we can do a spatial join of these <em>expanded</em> polygons with our “other grocer” dataset.</p> <p>To begin, buffer your block groups by 15 kilometers and set the new buffered polygons as your GeoDataFrame’s “offical geometry”</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[27]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates_w_dists</span><span class=p >[</span><span class=s2 >"buffered_geometry"</span><span class=p >]</span> <span class=o >=</span> <span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >buffer</span><span class=p >(</span><span class=mi >15_000</span><span class=p >)</span>
<span class=n >candidates_w_dists</span> <span class=o >=</span> <span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >set_geometry</span><span class=p >(</span><span class=s2 >"buffered_geometry"</span><span class=p >)</span>

</pre></div> </div> </div> <h2 id=Exercise-11 >Exercise 11<a class=headerlink  href="#Exercise-11" title="Permalink to this headline">¶</a></h2> <p>Now merge your buffered polygons with your GeoDataFrame of other grocers.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[28]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >competitors</span><span class=p >[</span><span class=s2 >"competitor"</span><span class=p >]</span> <span class=o >=</span> <span class=mi >1</span>
</pre></div> </div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[29]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >candidates_w_buff</span> <span class=o >=</span> <span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >sjoin</span><span class=p >(</span>
    <span class=n >competitors</span><span class=p >[[</span><span class=s2 >"competitor"</span><span class=p >,</span> <span class=s2 >"geometry"</span><span class=p >]],</span> <span class=n >how</span><span class=o >=</span><span class=s2 >"left"</span>
<span class=p >)</span>

</pre></div> </div> </div> <h2 id=Exercise-12 >Exercise 12<a class=headerlink  href="#Exercise-12" title="Permalink to this headline">¶</a></h2> <p>Now we have a dataset where we have one row for every (block-group) x (grocer within 15km) combination, so the next thing we have to do is collapse our data back down to the block-group level. So let’s groupby our data to get the COUNT of competitors within 15km.</p> <p>Bear in mind that each block group is unique identified by <code class="docutils literal notranslate"><span class=pre >"STATEFP",</span> <span class=pre >"COUNTYFP",</span> <span class=pre >"TRACTCE",</span> <span class=pre >"BLKGRPCE"</span></code>. Also note you won’t be able to groupby with your geometry columns in there, so you’ll need to do a groupby with a subset of columns, then merge your results back in.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[30]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >x</span> <span class=o >=</span> <span class=n >candidates_w_buff</span><span class=o >.</span><span class=n >groupby</span><span class=p >(</span>
    <span class=p >[</span><span class=s2 >"STATEFP"</span><span class=p >,</span> <span class=s2 >"COUNTYFP"</span><span class=p >,</span> <span class=s2 >"TRACTCE"</span><span class=p >,</span> <span class=s2 >"BLKGRPCE"</span><span class=p >],</span> <span class=n >as_index</span><span class=o >=</span><span class=kc >False</span>
<span class=p >)[[</span><span class=s2 >"competitor"</span><span class=p >]]</span><span class=o >.</span><span class=n >sum</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[31]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >cand_w_count</span> <span class=o >=</span> <span class=n >candidates_w_dists</span><span class=o >.</span><span class=n >merge</span><span class=p >(</span>
    <span class=n >x</span><span class=p >,</span> <span class=n >on</span><span class=o >=</span><span class=p >[</span><span class=s2 >"STATEFP"</span><span class=p >,</span> <span class=s2 >"COUNTYFP"</span><span class=p >,</span> <span class=s2 >"TRACTCE"</span><span class=p >,</span> <span class=s2 >"BLKGRPCE"</span><span class=p >],</span> <span class=n >validate</span><span class=o >=</span><span class=s2 >"1:1"</span><span class=p >,</span> <span class=n >how</span><span class=o >=</span><span class=s2 >"left"</span>
<span class=p >)</span>

</pre></div> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[32]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >cand_w_count</span><span class=o >.</span><span class=n >competitor</span><span class=o >.</span><span class=n >value_counts</span><span class=p >()</span><span class=o >.</span><span class=n >sort_index</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[32]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
0.0      244
1.0      391
2.0      349
3.0      302
4.0      186
        ...
330.0      2
331.0      5
332.0      4
334.0      2
336.0      1
Name: competitor, Length: 331, dtype: int64
</pre></div></div> </div> <h2 id=Exercise-13 >Exercise 13<a class=headerlink  href="#Exercise-13" title="Permalink to this headline">¶</a></h2> <p>Now let’s try using the same filter we used before, but this time subsetting for census block groups with <em>less than three competitors</em> within 15km <em>and</em> no competitors within 5km.</p> <p>So:</p> <ul class=simple > <li><p>college degrees is over 50%,</p> <li><p>median household income is over $90,000,</p> <li><p>nearest competitor’s grocery store is more than 5km away,</p> <li><p>the nearest Whole Foods is over 5km away,</p> <li><p>less than 3 competitors within 15km.</p> </ul> <p>What counties seem like the most plausible new locations now?</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[33]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span> <span class=o >=</span> <span class=n >cand_w_count</span><span class=p >[</span>
    <span class=p >(</span><span class=n >cand_w_count</span><span class=o >.</span><span class=n >md_hh_inc</span> <span class=o >&gt;</span> <span class=mi >90_000</span><span class=p >)</span>
    <span class=o >&amp;</span> <span class=p >(</span><span class=n >cand_w_count</span><span class=o >.</span><span class=n >share_with_college</span> <span class=o >&gt;</span> <span class=mf >0.5</span><span class=p >)</span>
    <span class=o >&amp;</span> <span class=p >(</span><span class=n >cand_w_count</span><span class=o >.</span><span class=n >competitor</span> <span class=o >&lt;</span> <span class=mi >3</span><span class=p >)</span>
    <span class=o >&amp;</span> <span class=p >(</span><span class=n >cand_w_count</span><span class=o >.</span><span class=n >other_grocer</span> <span class=o >&gt;</span> <span class=mi >5000</span><span class=p >)</span>
<span class=p >]</span>
<span class=n >finals</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>

</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[33]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_47_1.png" src="../_images/exercises_Solutions_gis_siting_47_1.png"/> </div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[34]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span><span class=o >.</span><span class=n >COUNTY</span><span class=o >.</span><span class=n >value_counts</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[34]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
Saratoga County        12
Suffolk County          4
Westchester County      3
Cayuga County           1
St. Lawrence County     1
Chautauqua County       1
Niagara County          1
Erie County             1
Oswego County           1
Name: COUNTY, dtype: int64
</pre></div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[35]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span><span class=o >.</span><span class=n >groupby</span><span class=p >(</span><span class=s2 >"COUNTY"</span><span class=p >)[[</span><span class=s2 >"population"</span><span class=p >]]</span><span class=o >.</span><span class=n >sum</span><span class=p >()</span><span class=o >.</span><span class=n >sort_values</span><span class=p >(</span><span class=s2 >"population"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[35]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <div> <style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>population <tr> <th>COUNTY <th> <tr> <th>Chautauqua County <td>366 <tr> <th>Cayuga County <td>503 <tr> <th>St. Lawrence County <td>744 <tr> <th>Erie County <td>1074 <tr> <th>Oswego County <td>1185 <tr> <th>Niagara County <td>1307 <tr> <th>Suffolk County <td>3342 <tr> <th>Westchester County <td>5239 <tr> <th>Saratoga County <td>16349 </table> </div></div> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[36]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre>
<span></span><span class=n >finals</span><span class=p >[</span><span class=n >finals</span><span class=o >.</span><span class=n >COUNTY</span> <span class=o >==</span> <span class=s2 >"Saratoga County"</span><span class=p >]</span><span class=o >.</span><span class=n >set_geometry</span><span class=p >(</span><span class=s2 >"geometry"</span><span class=p >)</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[36]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/exercises_Solutions_gis_siting_50_1.png" src="../_images/exercises_Solutions_gis_siting_50_1.png"/> </div> </div> <p>Sure seems like Saratoga County is the place to be!</p> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2021, Nick Eubank. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.1.2. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>